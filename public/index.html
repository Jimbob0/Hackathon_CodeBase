<!DOCTYPE html>
<html>
<head>
	<title>CodeBase Home Page</title>

	<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha256-cCueBR6CsyA4/9szpPfrX3s49M9vUU5BgtiJj06wt/s=" crossorigin="anonymous"></script>

	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
	
	<link rel="stylesheet" type="text/css" href="./css/homestyle.css">

	<script>
		//show all of the titles and votes for each post
		function showPosts(){
            $('#post_list').html("<h1>Loading...</h1>");
			$.get("/posts",function(data){
				$('#post_list').html("");
				for(var i = 0; i < data.length; i++){
                    console.log(data[i])
					$('#post_list').append(
                        "<li class='list-group-item post_title' id='" +
                        data[i]._id +
                        "'><a id='title" + 
                        data[i]._id + 
                        "'>" + 
                        data[i].title + 
                        "</a><button class='check' id='report" + 
                        data[i]._id + 
                        "'><span class='glyphicon glyphicon-alert'></span></button></div><div class='check' id='likevalue" +
                        data[i]._id + 
                        "'>" + 
                        data[i].votes +
                        "</div><button class='check'><span class='glyphicon glyphicon-thumbs-up' id='vote" +
                        data[i]._id + 
                        "'></span></button></li>"
                    );
				}
			});
		}
		//show the answer of the selected title 
		function showAns(id){
			$.get("/posts",function(data){
				var answer = data.find({
                    _id: id, 
					body: 1
                },
					function(err, data){
						if (err){
                            console.log(err);
	 						return err;
						}
						return (data);
	 				}
				);
				$('#ans').html(answer); 
			});
		}

		function upVote(id){ 
			$.post("/posts", function(data){
				data.findOneAndUpdate({
                    _id: id, 
					$inc: {votes: 1}
				});
			});
		}

		//mockup without db implementation NEEDS UPDATE
		$(document).ready(function(){
			showPosts();
            /* What does 'id' need to be changed to so that it connects with the id of a particular element
			$("#title"+id).click(showAns(id));
			$("#post"+id).click(upVote(id));
			$("#post"+id).click(showPosts);
            */
        });


	</script>
</head>
<body>
	<nav class="navbar navbar-default water" id="water" style="margin-bottom: 0px">
  		<div class="container-fluid">
    	<!-- Brand and toggle get grouped for better mobile display -->
    	<div class="navbar-header">
	      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
	        <span class="sr-only">Toggle navigation</span>
	        <span class="icon-bar"></span>
	        <span class="icon-bar"></span>
	        <span class="icon-bar"></span>
	      </button>
	      <a class="navbar-brand" href="#">Team Blue</a>
	    </div>
    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="./index.html" class="titletab">Home</a></li>
        <li><a href="./login.html" class="titletab">Login</a></li>
        <li><a href="./new_post.html" class="titletab">New Post</a></li>
      </ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>
	<div class="back">
		<div>
			<a href="/logout">
				<button id="far"><a href="#">Logout</a></button>
			</a>
		</div>
		<div class="title">
			<p class="title">CodeBase</p>
			<h4 class="titledesc">It's raining cats and codes!</h4>
		</div>
		<div class="container">
			<div class="col-md-8" id="posts">
				<font color="white">Posts</font>
				<ul class="list-group" id="post_list">
	  				<li class="list-group-item"><a id="dummypost">Fake Title</a>
	  					<div class="check" id="report"><button>Report</button></div>
	  					<div class="check" id="likevalue">#?</div>
	  					<div class="check">
	  						<a href="#">
          						<span class="glyphicon glyphicon-thumbs-up"></span>
        					</a>
        				</div>
	  				</li>
				</ul>
			</div>
		<div id="contain">
				<div class="col-md-4" id="ans">
					<div id ="sna">Scrolling Answer
					</div>
				</div>
		</div>
	</div>
	<div>
		<a href="./creators.html"><button class="navbar navbar-default foot">
		<!-- This is the footer about the CodeBase creators. -->
		<p>Learn more about the CodeBase creators!</p>
			</button>
		</a>
	</div>
	

</body>
</html>
